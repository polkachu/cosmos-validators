---
- name: register public ip
  uri:
    url: 'https://api.ipify.org?format=json'
  register: public_ip

- name: apply settings that effect all node types
  import_tasks: handle_all.yml

- name: handle main-specific
  import_tasks: handle_main.yml
  when: type is defined and (type == 'backup' or type == 'main')

- name: handle non-main
  import_tasks: handle_other.yml
  when: type is defined and type != 'main'

- name: handle testnet
  import_tasks: handle_testnet.yml
  when: type is defined and type == 'testnet'

- name: 
  lineinfile:
    path: '{{ user_dir }}/{{ folder }}/config/app.toml'
    regexp: '^contract-memory-enclave-cache-size ='
    line: 'contract-memory-enclave-cache-size = "15"'
    state: present 
  when: network == 'secret'
